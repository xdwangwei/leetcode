package com.queue;

import java.util.ArrayList;
import java.util.List;
import java.util.PriorityQueue;

/**
 * @author wangwei
 * @date 2022/12/24 15:14
 * @description: _373_KPairsWithSmallestSum
 *
 * 373. å’Œæœ€å°çš„ k ä¸ªæ•°å¯¹
 * ç»™å®šä¸¤ä¸ªä»¥å‡åºæ’åˆ—çš„æ•´æ•°æ•°ç»„ nums1 å’Œ nums2 , ä»¥åŠä¸€ä¸ªæ•´æ•° k ã€‚
 *
 * å®šä¹‰ä¸€å¯¹å€¼ (u,v)ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ¥è‡ª nums1ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ¥è‡ª nums2 ã€‚
 *
 * è¯·æ‰¾åˆ°å’Œæœ€å°çš„ k ä¸ªæ•°å¯¹ (u1,v1),  (u2,v2)  ...  (uk,vk) ã€‚
 *
 *
 *
 * ç¤ºä¾‹ 1:
 *
 * è¾“å…¥: nums1 = [1,7,11], nums2 = [2,4,6], k = 3
 * è¾“å‡º: [1,2],[1,4],[1,6]
 * è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 3 å¯¹æ•°ï¼š
 *     [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]
 * ç¤ºä¾‹ 2:
 *
 * è¾“å…¥: nums1 = [1,1,2], nums2 = [1,2,3], k = 2
 * è¾“å‡º: [1,1],[1,1]
 * è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 2 å¯¹æ•°ï¼š
 *      [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]
 * ç¤ºä¾‹ 3:
 *
 * è¾“å…¥: nums1 = [1,2], nums2 = [3], k = 3
 * è¾“å‡º: [1,3],[2,3]
 * è§£é‡Š: ä¹Ÿå¯èƒ½åºåˆ—ä¸­æ‰€æœ‰çš„æ•°å¯¹éƒ½è¢«è¿”å›:[1,3],[2,3]
 *
 *
 * æç¤º:
 *
 * 1 <= nums1.length, nums2.length <= 104
 * -109 <= nums1[i], nums2[i] <= 109
 * nums1, nums2 å‡ä¸ºå‡åºæ’åˆ—
 * 1 <= k <= 1000
 *
 *
 */
public class _373_KPairsWithSmallestSum {


    /**
     * æ–¹æ³•ä¸€ï¼šä¼˜å…ˆé˜Ÿåˆ—
     * æ€è·¯
     *
     * å¯¹äºå·²ç»æŒ‰å‡åºæ’åˆ—çš„ä¸¤ä¸ªæ•°ç»„ nums1,nums2ï¼Œé•¿åº¦åˆ†åˆ«ä¸º m,nï¼Œ
     * æˆ‘ä»¬å¯ä»¥çŸ¥é“å’Œæœ€å°çš„æ•°å¯¹ä¸€å®šä¸º (num1[0], nums2[0])ï¼Œå’Œæœ€å¤§çš„æ•°å¯¹ä¸€å®šä¸º (nums1[m-1], nums2[n-1])
     *
     * æœ¬é¢˜è¦æ±‚æ‰¾åˆ°æœ€å°çš„ k ä¸ªæ•°å¯¹ï¼Œæœ€ç›´æ¥çš„åŠæ³•æ˜¯å¯ä»¥å°†æ‰€æœ‰çš„æ•°å¯¹æ±‚å‡ºæ¥ï¼Œç„¶ååˆ©ç”¨æ’åºæˆ–è€… TopK è§£æ³•æ±‚å‡ºæœ€å°çš„ k ä¸ªæ•°å¯¹å³å¯ã€‚
     * å®é™…æ±‚è§£æ—¶å¯ä»¥ä¸ç”¨æ±‚å‡ºæ‰€æœ‰çš„æ•°å¯¹ï¼Œåªéœ€ä»æ‰€æœ‰ç¬¦åˆå¾…é€‰çš„æ•°å¯¹ä¸­é€‰å‡ºæœ€å°çš„å³å¯ï¼Œ
     * å‡è®¾å½“å‰å·²é€‰çš„å‰ n å°æ•°å¯¹çš„ç´¢å¼•åˆ†åˆ«ä¸º (a1,b1),(a2,b2),(a3,b3),...,(an,bn)ï¼Œ
     * ç”±äºä¸¤ä¸ªæ•°ç»„éƒ½æ˜¯æŒ‰ç…§å‡åºè¿›è¡Œæ’åºçš„ï¼Œåˆ™å¯ä»¥æ¨å‡º
     * ç¬¬ n+1 å°çš„æ•°å¯¹çš„ç´¢å¼•é€‰æ‹©èŒƒå›´ä¸º (a1+1,b1),(a1,b1+1),(a2+1,b2),(a2,b2+1),(a3+1,b3),(a3,b3+1),...,(an+1,bn),(an,bn+1)ï¼Œ
     *
     * å‡è®¾æˆ‘ä»¬åˆ©ç”¨å †çš„ç‰¹æ€§å¯ä»¥æ±‚å‡ºå¾…é€‰èŒƒå›´ä¸­æœ€å°æ•°å¯¹çš„ç´¢å¼•ä¸º (a_i,b_i)ï¼Œ
     * åŒæ—¶å°†æ–°çš„å¾…é€‰çš„æ•°å¯¹ (a_i+1,b_i),(a_i,b_i+1) åŠ å…¥åˆ°å †ä¸­ï¼Œç›´åˆ°æˆ‘ä»¬é€‰å‡º k ä¸ªæ•°å¯¹å³å¯ã€‚
     *
     * å¦‚æœæˆ‘ä»¬æ¯æ¬¡éƒ½å°†å·²é€‰çš„æ•°å¯¹ (a_i,b_i) çš„å¾…é€‰ç´¢å¼• (a_i+1,b_i),(a_i,b_i+1) åŠ å…¥åˆ°å †ä¸­åˆ™å¯èƒ½å‡ºç°é‡å¤æ·»åŠ çš„é—®é¢˜ï¼Œ
     * ä¸€èˆ¬éœ€è¦è®¾ç½®æ ‡è®°ä½è§£å†³å»é‡çš„é—®é¢˜ã€‚
     * æˆ‘ä»¬å¯ä»¥å°† nums1 çš„å‰ k ä¸ªç´¢å¼•æ•°å¯¹ (0,0),(1,0),â€¦,(kâˆ’1,0) åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ï¼Œ
     * æ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºå…ƒç´  (x,y) æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°† nums2 çš„ç´¢å¼•(x, y+1)å¢åŠ å³å¯ï¼Œè¿™æ ·é¿å…äº†é‡å¤åŠ å…¥å…ƒç´ çš„é—®é¢˜ã€‚
     *
     * è¿™å…¶å®æ˜¯ä¸€ç§å¤šè·¯å½’å¹¶çš„æ€è·¯ï¼š
     * ã€å¤šè·¯å½’å¹¶ã€‘
     * ä»¤ nums1 çš„é•¿åº¦ä¸º nï¼Œnums2 çš„é•¿åº¦ä¸º mï¼Œæ‰€æœ‰çš„ç‚¹å¯¹æ•°é‡ä¸º nâˆ—mã€‚
     *
     * å…¶ä¸­æ¯ä¸ª nums1[i] å‚ä¸æ‰€ç»„æˆçš„ç‚¹åºåˆ—ä¸ºï¼š
     *
     * [(nums1[0],nums2[0]),  (nums1[0],nums2[1]), ... ,(nums1[0],nums2[mâˆ’1])]
     * [(nums1[1],nums2[0]),  (nums1[1],nums2[1]), ... ,(nums1[1],nums2[mâˆ’1])]
     * ...
     * [(nums1[nâˆ’1],nums2[0]),(nums1[nâˆ’1],nums2[1]),...,(nums1[nâˆ’1],nums2[mâˆ’1])]
     *
     * ç”±äº nums1 å’Œ nums2 å‡å·²æŒ‰å‡åºæ’åºï¼Œå› æ­¤æ¯ä¸ª nums1[i] å‚ä¸æ„æˆçš„ç‚¹åºåˆ—ä¹Ÿä¸ºå‡åºæ’åºï¼Œè§†ä¸ºä¸€ä¸ªæœ‰åºé“¾è¡¨
     * æˆ‘ä»¬çš„ç›®çš„å®é™…ä¸Šæ˜¯åˆå¹¶è¿™nä¸ªæœ‰åºåºåˆ—ï¼Œå¹¶é€‰æ‹©æœ€ç»ˆç»“æœçš„å‰kä¸ªã€‚
     * æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ã€åˆå¹¶kä¸ªæœ‰åºé“¾è¡¨ã€‘çš„æ€è·¯ï¼Œæ¥ä¼˜åŒ–ç©ºé—´å¤æ‚åº¦åˆ°O(k)æ¥å®Œæˆæ­¤è¿‡ç¨‹ï¼š
     *
     * å…·ä½“çš„ï¼Œèµ·å§‹æˆ‘ä»¬å°†è¿™ n ä¸ªåºåˆ—çš„é¦–ä½å…ƒç´ ï¼ˆç‚¹å¯¹ï¼‰ä»¥äºŒå…ƒç»„ (i,j) æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå°æ ¹å †ï¼‰ï¼Œ
     * å…¶ä¸­ i ä¸ºè¯¥ç‚¹å¯¹ä¸­ nums1[i] çš„ä¸‹æ ‡ï¼Œj ä¸ºè¯¥ç‚¹å¯¹ä¸­ nums2[j] çš„ä¸‹æ ‡ï¼Œè¿™æ­¥æ“ä½œçš„å¤æ‚åº¦ä¸º O(nlogn)ã€‚

     * æ¯æ¬¡ä»ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ä¸­å–å‡ºå †é¡¶å…ƒç´ ï¼ˆå«ä¹‰ä¸ºå½“å‰æœªè¢«åŠ å…¥åˆ°ç­”æ¡ˆçš„æ‰€æœ‰ç‚¹å¯¹ä¸­çš„æœ€å°å€¼ï¼‰ï¼ŒåŠ å…¥ç­”æ¡ˆï¼Œ
     * å¹¶å°†è¯¥ç‚¹å¯¹æ‰€åœ¨åºåˆ—çš„ä¸‹ä¸€ä½ï¼ˆå¦‚æœæœ‰ï¼‰åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—ä¸­ã€‚
     *
     * ä¸¾ä¸ª ğŸŒ°ï¼Œé¦–æ¬¡å–å‡ºçš„äºŒå…ƒç»„ä¸º (0,0)ï¼Œå³ç‚¹å¯¹ (nums1[0],nums2[0])ï¼Œ
     * å–å®Œåå°†åºåˆ—çš„ä¸‹ä¸€ä½ç‚¹å¯¹ (nums1[0],nums2[1]) ä»¥äºŒå…ƒç»„ (0,1) å½¢å¼æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ã€‚
     *
     * å¯é€šè¿‡ã€Œåè¯æ³•ã€è¯æ˜ï¼Œæ¯æ¬¡è¿™æ ·çš„ã€Œå–å½“å‰ï¼Œæ”¾å…¥ä¸‹ä¸€ä½ã€çš„æ“ä½œï¼Œå¯ä»¥ç¡®ä¿å½“å‰æœªè¢«åŠ å…¥ç­”æ¡ˆçš„æ‰€æœ‰ç‚¹å¯¹çš„æœ€å°å€¼å¿…ç„¶åœ¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ä¸­ï¼Œ
     * å³å‰ k ä¸ªå‡ºå †çš„å…ƒç´ å¿…ç„¶æ˜¯æ‰€æœ‰ç‚¹å¯¹çš„å‰ k å°çš„å€¼ã€‚
     *
     * ä½œè€…ï¼šAC_OIer
     * é“¾æ¥ï¼šhttps://leetcode.cn/problems/find-k-pairs-with-smallest-sums/solution/gong-shui-san-xie-duo-lu-gui-bing-yun-yo-pgw5/
     * æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
     * è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
     *
     * ä½œè€…ï¼šLeetCode-Solution
     * é“¾æ¥ï¼šhttps://leetcode.cn/problems/find-k-pairs-with-smallest-sums/solution/cha-zhao-he-zui-xiao-de-kdui-shu-zi-by-l-z526/
     * æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
     * è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
     * @param nums1
     * @param nums2
     * @param k
     * @return
     */
    public List<List<Integer>> kSmallestPairs(int[] nums1, int[] nums2, int k) {
        int m = nums1.length, n = nums2.length;
        // ç»´æŠ¤å¤§å°ä¸ºkçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—å…ƒç´ ä¸º(x,y)è¡¨ç¤º(nums1[x],nums2[y])ï¼ŒæŒ‰ç…§æ•°å¯¹å’Œä»å°åˆ°è¾¾æ’åº
        PriorityQueue<int[]> queue = new PriorityQueue<>((o1, o2) -> nums1[o1[0]] + nums2[o1[1]] - nums1[o2[0]] - nums2[o2[1]]);
        // åŠ å…¥nums1å„ä¸ªå…ƒç´ ä¸nums2[0,1,2,...]å½¢æˆçš„æœ‰åºæ•°å¯¹é“¾è¡¨çš„å¤´å…ƒç´ ï¼Œå³ï¼ˆnums1[?],nums2[0]ï¼‰
        // ç”±äºæœ€ç»ˆåªéœ€è¦å‰kä¸ªç»“æœï¼Œå› æ­¤æˆ‘ä»¬åˆå¹¶è¿™mä¸ªé“¾è¡¨ä¸­å‰kä¸ªé“¾è¡¨å³å¯ã€‚
        for (int i = 0; i < Math.min(m, k); ++i) {
            queue.offer(new int[]{i, 0});
        }
        List<List<Integer>> result = new ArrayList<>();
        // ä»é˜Ÿåˆ—ä¸­å–å‡ºkä¸ªå…ƒç´ å°±åœæ­¢
        while (k-- > 0 && !queue.isEmpty()) {
            int[] pair = queue.poll();
            int idx1 = pair[0], idx2 = pair[1];
            // åŠ å…¥å½“å‰æ•°å¯¹
            result.add(List.of(nums1[idx1], nums2[idx2]));
            // åŠ å…¥å½“å‰å…ƒç´ åœ¨å½“å‰é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ 
            if (idx2 + 1 < n) {
                queue.offer(new int[]{idx1, idx2 + 1});
            }
        }
        // è¿”å›
        return result;
    }
}
